<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"> <meta name="description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur."> <meta name="keywords" content="robotix, robotics, iit, kgp, team, events, society, technology, tutorial"> <meta name="google-site-verification" content="ZR618hQWwV_OwtWa033492kzvBaQYxBc1ZauYc5oO5A" /> <!-- Social: Twitter --> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@robotixiitkgp"> <meta name="twitter:title" content="Normal Bayes Classifier"> <meta name="twitter:description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur."> <meta name="twitter:image:src" content="/img/favicons/favicon-196x196.png"> <!-- Social: Facebook / Open Graph --> <meta property="og:title" content="Normal Bayes Classifier" /> <meta property="og:site_name" content="Technology Robotix Society, IIT Kharagpur" /> <meta property="og:type" content="website" /> <meta property="og:image" content="/img/favicons/favicon-196x196.png" /> <meta property="og:description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur." /> <!-- Social: Google+ --> <link href="https://plus.google.com/102868621563384739622" rel="publisher"> <title>Normal Bayes Classifier &bull; Technology Robotix Society, IIT Kharagpur</title> <link rel="shortcut icon" href="/img/favicons/favicon.ico"> <link rel="apple-touch-icon" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png"> <link rel="apple-touch-icon" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png"> <link rel="apple-touch-icon" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png"> <link rel="apple-touch-icon" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png"> <link rel="apple-touch-icon" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png"> <link rel="apple-touch-icon" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png"> <link rel="apple-touch-icon" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png"> <link rel="apple-touch-icon" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-160x160.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png"> <meta name="msapplication-TileColor" content="#2b5797"> <meta name="msapplication-TileImage" content="/img/favicons/mstile-144x144.png"> <meta name="msapplication-config" content="/img/favicons/browserconfig.xml"> <meta name="theme-color" content="#2b5797"> <link href="/css/main.css" rel="stylesheet"> <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --> <!-- WARNING: Respond.js doesn't work if you view the page via file:// --> <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]--> </head> <body> <div id="st-container" class="st-container"> <div class="st-pusher"> <div class="st-content"> <!-- Begin Top Section --> <section id="top-section" class="top-section image-section " style=""> <div class="overlay gradient-overlay"></div> <header id="top-header" class="top-header"> <div class="overlay white-solid"></div> <svg id="menu-trigger" class="menu-trigger icn icon-menu visible-xs" viewBox="0 0 32 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-menu"></use> </svg> <a href="/" id="logo-header" class="logo-header"> <div class="logo"></div> </a> <nav class="st-menu st-effect" id="menu"> <div class="logo-navbar logo visible-xs"></div> <ul> <li> <a class="" href=" https://makerspace.robotix.in/" target="_blank">Makerspace</a> </li> <li> <a class="" href="/FAQs/" >FAQs</a> </li> <li> <a class="" href="/workshops/" >Workshops</a> </li> <li> <a class="" href="/event/" >Events</a> </li> <li> <a class="" href="/blog/" >Blog</a> </li> <li> <a class="" href="/tutorial" >Tutorials</a> </li> <li> <a class="" href="/team/" >Team</a> </li> <li> <a class="" href="/about-us/" >About Us</a> </li> </ul> <ul id="bottom-navlinks" class="bottom-navlinks visible-xs"> <li> <a href="https://contact.robotix.in" target="_blank">Contact Us</a> </li> </ul> </nav> </header> <div class="content-wrapper"> <div class="jumbotron text-left"> <div class="animated hiding" data-animation="fadeInLeft" data-delay="500"> <h1>Normal Bayes Classifier</h1> </div> </div> </div> </section> <!-- End Top Section --> <!-- Begin Post--> <section id="post-section" class="post-section"> <div class="content-wrapper text-left"> <div class="col-md-10 col-sm-10 col-lg-offset-2 col-md-offset-2 col-sm-offset-1"> <div class="col-lg-8 col-md-10 col-xs-12"> <article class="row post"> <div class="post-body"><h4 id="normal-bayes-classifier-ocr-example">Normal Bayes Classifier (OCR Example)</h4> <h5 id="understanding-normal-bayes-classifier">Understanding Normal Bayes Classifier</h5> <p>A Normal Bayes Classifier is also known as the Naive Bayes Classifier. According to <a href="http://en.wikipedia.org/wiki/Naive_Bayes_classifier">wikipedia</a>, A naive Bayes classifier is a term in Bayesian statistics dealing with a simple probabilistic classifier based on applying Bayes’ theorem with strong (naive) independence assumptions. A more descriptive term for the underlying probability model would be “independent feature model”.</p> <p>In simple terms, a naive Bayes classifier assumes that the presence (or absence) of a particular feature of a class is unrelated to the presence (or absence) of any other feature. For example, a fruit may be considered to be an apple if it is red, round, and about 4” in diameter. Even though these features depend on the existence of the other features, a naive Bayes classifier considers all of these properties to independently contribute to the probability that this fruit is an apple.</p> <p>Depending on the precise nature of the probability model, naive Bayes classifiers can be trained very efficiently in a supervised learning setting. In many practical applications, parameter estimation for naive Bayes models uses the method of maximum likelihood; in other words, one can work with the naive Bayes model without believing in Bayesian probability or using any Bayesian methods.</p> <p>In spite of their naive design and apparently over-simplified assumptions, naive Bayes classifiers often work much better in many complex real-world situations than one might expect. Recently, careful analysis of the Bayesian classification problem has shown that there are some theoretical reasons for the apparently unreasonable efficacy of naive Bayes classifiers. An advantage of the naive Bayes classifier is that it requires a small amount of training data to estimate the parameters (means and variances of the variables) necessary for classification. Because independent variables are assumed, only the variances of the variables for each class need to be determined and not the entire covariance matrix.</p> <h5 id="handwritten-digit-ocr">Handwritten Digit OCR</h5> <p>Now that we have a fairly good idea about Normal Bayes Classifier, we will implement an OCR for handwritten digits. We will be provided with two datasets (training and testing). A 32x32 bitmap image of each digit is compressed to 8x8 and then it is flattened to a row vector containing 64 features. At the end of each line in the training dataset is an integer whose range is from 0-9, which is the label corresponding to the digit in the image. The testing dataset is similar to the training dataset but it is unlabeled. The datasets which are used in this example is available <a href="http://archive.ics.uci.edu/ml/machine-learning-databases/optdigits/">here</a>.</p> <h6 id="c-implementation">C++ Implementation</h6> <p>First we include all the necessary header files and set some constants. Our dataset contains 3823 training examples and 1797 test examples.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;iostream&gt;
#include &lt;stdio.h&gt;
#include &lt;opencv2/highgui/highgui.hpp&gt;
#include &lt;opencv2/core/core.hpp&gt;
#include &lt;opencv2/imgproc/imgproc.hpp&gt;
#include &lt;opencv2/ml/ml.hpp&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">cv</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">TRAINING_EXAMPLES</span> <span class="o">=</span> <span class="mi">3823</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">TEST_EXAMPLES</span> <span class="o">=</span> <span class="mi">1797</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">NUM_FEATURES</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span></code></pre></figure> <p>Now we need to load the data to our program. The training data is stored in a file called <code class="highlighter-rouge">optdigits.tra</code> and the test data is store in <code class="highlighter-rouge">optdigits.tes</code>. We will not use file IO in this example but instead we will pipe the input files while calling the executable. So here is the code for reading the datasets. We will create the four necessary <code class="highlighter-rouge">Mat</code> variables; <code class="highlighter-rouge">trainingData</code>, <code class="highlighter-rouge">trainingClasses</code>, <code class="highlighter-rouge">testData</code>, <code class="highlighter-rouge">testClasses</code> and load all the data into these variables.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">float</span> <span class="n">feature</span><span class="p">,</span> <span class="n">cls</span><span class="p">;</span>
<span class="n">Mat</span> <span class="n">trainingData</span><span class="p">(</span><span class="n">TRAINING_EXAMPLES</span><span class="p">,</span> <span class="n">NUM_FEATURES</span><span class="p">,</span> <span class="n">DataType</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">type</span><span class="p">);</span>
<span class="n">Mat</span> <span class="n">trainingClasses</span><span class="p">(</span><span class="n">TRAINING_EXAMPLES</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DataType</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">type</span><span class="p">);</span>
<span class="n">Mat</span> <span class="n">testData</span><span class="p">(</span><span class="n">TEST_EXAMPLES</span><span class="p">,</span> <span class="n">NUM_FEATURES</span><span class="p">,</span> <span class="n">DataType</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">type</span><span class="p">);</span>
<span class="n">Mat</span> <span class="n">testClasses</span><span class="p">(</span><span class="n">TEST_EXAMPLES</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DataType</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">type</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">TRAINING_EXAMPLES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">NUM_FEATURES</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%f,"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">feature</span><span class="p">);</span>
		<span class="n">trainingData</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">feature</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">cls</span><span class="p">;</span>
	<span class="n">trainingClasses</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">cls</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">TEST_EXAMPLES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">NUM_FEATURES</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%f,"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">feature</span><span class="p">);</span>
		<span class="n">testData</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">feature</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">cls</span><span class="p">;</span>
	<span class="n">testClasses</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">cls</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <p>Now that our data is loaded we will train the classifier. We will create a separate function for this and call it <code class="highlighter-rouge">bayes</code> and make use of the class <code class="highlighter-rouge">CvNormalBayesClassifier</code> and its <code class="highlighter-rouge">train</code> method. This function will create a new <code class="highlighter-rouge">Mat</code> variable called <code class="highlighter-rouge">predicted</code> and in it store the predicted labels of the test dataset. Here is the function.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="nf">bayes</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">trainingData</span><span class="p">,</span> <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">trainingClasses</span><span class="p">,</span> <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">testData</span><span class="p">,</span> <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">testClasses</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CvNormalBayesClassifier</span> <span class="n">bayes</span><span class="p">(</span><span class="n">trainingData</span><span class="p">,</span> <span class="n">trainingClasses</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="n">predicted</span><span class="p">(</span><span class="n">testClasses</span><span class="p">.</span><span class="n">rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DataType</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">type</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">testData</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">const</span> <span class="n">Mat</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">testData</span><span class="p">.</span><span class="n">row</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="n">predicted</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">bayes</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure> <p>Now that we have trained and predicted from the respective datasets, we need an evaluation metric to determine how good the classifier performed. For this we will create another function to check the accuracy. We will keep a count of how many times we predicted the data correctly and then we will return this count divided by the number of test examples to get the accuracy.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">float</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">predicted</span><span class="p">,</span> <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">actual</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">actual</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">float</span> <span class="n">p</span> <span class="o">=</span> <span class="n">predicted</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="kt">float</span> <span class="n">a</span> <span class="o">=</span> <span class="n">actual</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span> <span class="n">t</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">/</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">actual</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <p>That is pretty much it. Here is complete code.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;iostream&gt;
#include &lt;stdio.h&gt;
#include &lt;opencv2/highgui/highgui.hpp&gt;
#include &lt;opencv2/core/core.hpp&gt;
#include &lt;opencv2/imgproc/imgproc.hpp&gt;
#include &lt;opencv2/ml/ml.hpp&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">cv</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">TRAINING_EXAMPLES</span> <span class="o">=</span> <span class="mi">3823</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">TEST_EXAMPLES</span> <span class="o">=</span> <span class="mi">1797</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">NUM_FEATURES</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>

<span class="kt">float</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">predicted</span><span class="p">,</span> <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">actual</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">actual</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">float</span> <span class="n">p</span> <span class="o">=</span> <span class="n">predicted</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="kt">float</span> <span class="n">a</span> <span class="o">=</span> <span class="n">actual</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span> <span class="n">t</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">/</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">actual</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">bayes</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">trainingData</span><span class="p">,</span> <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">trainingClasses</span><span class="p">,</span> <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">testData</span><span class="p">,</span> <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">testClasses</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CvNormalBayesClassifier</span> <span class="n">bayes</span><span class="p">(</span><span class="n">trainingData</span><span class="p">,</span> <span class="n">trainingClasses</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="n">predicted</span><span class="p">(</span><span class="n">testClasses</span><span class="p">.</span><span class="n">rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DataType</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">type</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">testData</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">const</span> <span class="n">Mat</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">testData</span><span class="p">.</span><span class="n">row</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="n">predicted</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">bayes</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Accuracy = "</span> <span class="o">&lt;&lt;</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">testClasses</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="k">const</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
	<span class="kt">float</span> <span class="n">feature</span><span class="p">,</span> <span class="n">cls</span><span class="p">;</span>
	<span class="n">Mat</span> <span class="n">trainingData</span><span class="p">(</span><span class="n">TRAINING_EXAMPLES</span><span class="p">,</span> <span class="n">NUM_FEATURES</span><span class="p">,</span> <span class="n">DataType</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">type</span><span class="p">);</span>
	<span class="n">Mat</span> <span class="n">trainingClasses</span><span class="p">(</span><span class="n">TRAINING_EXAMPLES</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DataType</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">type</span><span class="p">);</span>
	<span class="n">Mat</span> <span class="n">testData</span><span class="p">(</span><span class="n">TEST_EXAMPLES</span><span class="p">,</span> <span class="n">NUM_FEATURES</span><span class="p">,</span> <span class="n">DataType</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">type</span><span class="p">);</span>
	<span class="n">Mat</span> <span class="n">testClasses</span><span class="p">(</span><span class="n">TEST_EXAMPLES</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DataType</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">type</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">TRAINING_EXAMPLES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">NUM_FEATURES</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">"%f,"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">feature</span><span class="p">);</span>
			<span class="n">trainingData</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">feature</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">cls</span><span class="p">;</span>
		<span class="n">trainingClasses</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">cls</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">TEST_EXAMPLES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">NUM_FEATURES</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">"%f,"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">feature</span><span class="p">);</span>
			<span class="n">testData</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">feature</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">cls</span><span class="p">;</span>
		<span class="n">testClasses</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">cls</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">bayes</span><span class="p">(</span><span class="n">trainingData</span><span class="p">,</span> <span class="n">trainingClasses</span><span class="p">,</span> <span class="n">testData</span><span class="p">,</span> <span class="n">testClasses</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <p>After compiling the above program an executable called <code class="highlighter-rouge">bayes</code> was created. For supplying the input files in order, we should run the executable like this:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./bayes &lt; optdigits.tra &lt; optdigits.tes 
</code></pre></div></div> <p>If you run the program using the datasets mentioned above, you should get an accuracy of <strong>0.847524</strong> which is good for such a highly optimized and small dataset. The accuracy can be increased using more training data and higher number of features.</p> <h5 id="program-output">Program output:</h5> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Accuracy = 0.847524
</code></pre></div></div> </div> </article> </div> </div> </div> </section> <!-- End Post --> <!-- Begin Footer --> <footer id="footer" class="footer"> <div class="row"> <div class="logo logo-footer pull-right"></div> </div> <div class="row"> <div class="col-md-4 col-xs-6"> <h5>Links</h5> <ul> <li><a href="https://drive.google.com/open?id=1jNJHFE1QjGOHFwhhzn6e774odGv-6eFQ" target="_blank">Robotix App</a></li> <li><a href="https://robotix.in/event/" target="_blank">Events</a></li> <li><a href="https://robotix.in/tutorial/" target="_blank">Tutorials</a></li> </ul> </div> <div class="col-md-4 col-xs-6"> <h5>Contacts</h5> <ul> <li><a href="https://contact.robotix.in" target="_blank">Contact Us</a></li> </ul> </div> <div class="col-md-4 col-xs-6"> <h5>Archives</h5> <ul> <li><a href="https://2018.robotix.in/" target="_blank">Robotix 2018</a></li> <li><a href="https://2017.robotix.in/" target="_blank">Robotix 2017</a></li> <li><a href="https://2016.robotix.in/" target="_blank">Robotix 2016</a></li> </ul> </div> </div> <div class="row"> <div class="col-md-6 col-xs-12"> <ul class="social-links"> <li> <a href="https://plus.google.com/102868621563384739622/" target="_blank"> <svg class="icn icon-google-plus" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-google-plus"></use> </svg> </a> </li> <li> <a href="https://twitter.com/RobotixIITKgp" target="_blank"> <svg class="icn icon-twitter" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-twitter"></use> </svg> </a> </li> <li> <a href="https://facebook.com/robotixiitkgp" target="_blank"> <svg class="icn icon-facebook" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-facebook"></use> </svg> </a> </li> <li> <a href="https://www.youtube.com/robotixiitkgp" target="_blank"> <svg class="icn icon-youtube" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-youtube"></use> </svg> </a> </li> <li> <a href="/feed.xml" target="_blank"> <svg class="icn icon-rss" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-rss"></use> </svg> </a> </li> </ul> </div> </div> <div class="row"> <!-- Please don't delete this line--> <div class="col-md-6"> <p class="copyright"> &copy; 2018 Technology Robotix Society, IIT Kharagpur </p> </div> </div> </footer> <!-- End Footer --> </div> </div> </div> <!-- Begin Floating Action button--> <ul class="fab"> <li> <input type="text" class="search input-sm form-control" placeholder="Search the site..."> <button class="btn btn-danger waves-circle waves-effect waves-light waves-float rotate"> <h4 class="fab-text media-middle"><b>+</b></h4> </button> </li> </ul> <script> window.jQuery || document.write('<script src="/js/jquery-2.1.1.min.js"><\/script>') </script> <script> document.write('<script src="/js/bootstrap.min.js"><\/script>') </script> <script src="/js/default.min.js"></script> <script>Waves.displayEffect();</script> <script src="/js/scripts.min.js"></script> <script> (function(){ var handle = '@robotixiitkgp'; var a = document.createElement('script'); var m = document.getElementsByTagName('script')[0]; a.async = 1; a.src = 'https://nectar.ninja/api/v1/' + handle.slice(1); m.parentNode.insertBefore(a, m); })(); </script> <script> (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){ (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t); e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e); })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st'); _st('install','a_iioDrTs6zXmqH8x5Yr','2.0.0'); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-83617238-1', 'auto'); ga('send', 'pageview'); </script> </body> </html>
