<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"> <meta name="description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur."> <meta name="keywords" content="robotix, robotics, iit, kgp, team, events, society, technology, tutorial"> <meta name="google-site-verification" content="ZR618hQWwV_OwtWa033492kzvBaQYxBc1ZauYc5oO5A" /> <!-- Social: Twitter --> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@robotixiitkgp"> <meta name="twitter:title" content="Kalman Filter"> <meta name="twitter:description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur."> <meta name="twitter:image:src" content="/img/favicons/favicon-196x196.png"> <!-- Social: Facebook / Open Graph --> <meta property="og:title" content="Kalman Filter" /> <meta property="og:site_name" content="Technology Robotix Society, IIT Kharagpur" /> <meta property="og:type" content="website" /> <meta property="og:image" content="/img/favicons/favicon-196x196.png" /> <meta property="og:description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur." /> <!-- Social: Google+ --> <link href="https://plus.google.com/102868621563384739622" rel="publisher"> <title>Kalman Filter &bull; Technology Robotix Society, IIT Kharagpur</title> <link rel="shortcut icon" href="/img/favicons/favicon.ico"> <link rel="apple-touch-icon" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png"> <link rel="apple-touch-icon" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png"> <link rel="apple-touch-icon" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png"> <link rel="apple-touch-icon" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png"> <link rel="apple-touch-icon" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png"> <link rel="apple-touch-icon" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png"> <link rel="apple-touch-icon" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png"> <link rel="apple-touch-icon" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-160x160.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png"> <meta name="msapplication-TileColor" content="#2b5797"> <meta name="msapplication-TileImage" content="/img/favicons/mstile-144x144.png"> <meta name="msapplication-config" content="/img/favicons/browserconfig.xml"> <meta name="theme-color" content="#2b5797"> <link href="/css/main.css" rel="stylesheet"> <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --> <!-- WARNING: Respond.js doesn't work if you view the page via file:// --> <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]--> </head> <body> <div id="st-container" class="st-container"> <div class="st-pusher"> <div class="st-content"> <!-- Begin Top Section --> <section id="top-section" class="top-section image-section " style=""> <div class="overlay gradient-overlay"></div> <header id="top-header" class="top-header"> <div class="overlay white-solid"></div> <svg id="menu-trigger" class="menu-trigger icn icon-menu visible-xs" viewBox="0 0 32 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-menu"></use> </svg> <a href="/" id="logo-header" class="logo-header"> <div class="logo"></div> </a> <nav class="st-menu st-effect" id="menu"> <div class="logo-navbar logo visible-xs"></div> <ul> <li> <a class="" href=" https://makerspace.robotix.in/" target="_blank">Makerspace</a> </li> <li> <a class="" href="/FAQs/" >FAQs</a> </li> <li> <a class="" href="/workshops/" >Workshops</a> </li> <li> <a class="" href="/event/" >Events</a> </li> <li> <a class="" href="/blog/" >Blog</a> </li> <li> <a class="" href="/tutorial" >Tutorials</a> </li> <li> <a class="" href="/team/" >Team</a> </li> <li> <a class="" href="/about-us/" >About Us</a> </li> </ul> <ul id="bottom-navlinks" class="bottom-navlinks visible-xs"> <li> <a href="https://contact.robotix.in" target="_blank">Contact Us</a> </li> </ul> </nav> </header> <div class="content-wrapper"> <div class="jumbotron text-left"> <div class="animated hiding" data-animation="fadeInLeft" data-delay="500"> <h1>Kalman Filter</h1> </div> </div> </div> </section> <!-- End Top Section --> <!-- Begin Post--> <section id="post-section" class="post-section"> <div class="content-wrapper text-left"> <div class="col-md-10 col-sm-10 col-lg-offset-2 col-md-offset-2 col-sm-offset-1"> <div class="col-lg-8 col-md-10 col-xs-12"> <article class="row post"> <div class="post-body"><p><strong>Kalman Filter</strong> is an algorithm that uses series of measurement observed over time containing noises and other inaccuracies to predict best estimate of unknown variables that tend to be more accurate than a single measurement. There are many modifications in kalman filter resulting in new algorithm such as extended kalman filter (EKF) and unscented kalman filter. These models work on non linear systems. Following tutorial is on KF which works on linear system .To understand kalman filter you should be thorough with basics of normal distribution and little bit of linear algebra.</p> <p>In kalman filter we assume that all measurements and noises are probabilistic and have some mean and co variance. Kalman filter can be divided into two basic operations : 1.Prediction 2.Update An initial estimate is given then after that it continuously goes in loop between the two processes .<br /> <img src="/img/tutorial/advanced/pic1.jpg" alt="" class="img-responsive" /></p> <p>Lets start understanding it with a simple example.</p> <p>To understand what it does, take a look at the following data - if you were given the data in blue, it may be reasonable to predict that the green dot should follow, by simply extrapolating the linear trend from the few previous samples. However, how confident would you be predicting the dark red point on the right using that method? how confident would you about predicting the green point, if you were given the red series instead of the blue? <img src="/img/tutorial/advanced/pic2.png" alt="enter image description here" class="img-responsive" /> Now, let’s try and use the above to model our prediction.</p> <p>First we need to know the state of our system. State of system is the vector of parameters that we need to know to completely describe the system.For example if our system consists of car moving in one dimension then state of the system would be position and velocity of the car. In our case we will take y coordinate and slope as our state. It is generally denoted by <strong>x</strong>. The next thing we need is model for our system .It describes how our system behaves.In our case it is y(t)=y(t−1)+m(t−1) and m(t)=m(t−1) where t represents time. Expressing in matrix form</p> <p>$ x_t = \begin{bmatrix}y(t)\\ m(t)\end{bmatrix} = \begin{bmatrix} 1 &amp; 1 \\ 0 &amp; 1 \end{bmatrix}.\begin{bmatrix} y(t-1) \\ m(t-1) \end{bmatrix} = Fx_{t-1}$</p> <p>But our system would not be perfect so there must be noise known as state noise $v_t$ . It is assumed to be white noise(normally distributed with mean zero and some covariance). So our equation becomes</p> <p>$x_t = \begin{bmatrix} y(t) \\ m(t) \end{bmatrix} = \begin{bmatrix} 1 &amp;1 \\ 0 &amp; 1 \end{bmatrix}.\begin{bmatrix} y(t-1) \\ m(t-1) \end{bmatrix} = Fx_{t-1} + v_t$</p> <p>One final equation that we are missing with is measurement update equation. $measurement = \begin{bmatrix} 1 &amp; 0 \end{bmatrix}.\begin{bmatrix} y(t) \\ m(t) \end{bmatrix}$</p> <p>Again there will be some noise in the measurements we denote it with $w_t$It is also a white noise. $z_t = \begin{bmatrix} 1 &amp; 0 \end{bmatrix}.\begin{bmatrix} y(t) \\ m(t) \end{bmatrix} + w_t$ In kalman filter everything is represented by normal distribution. Applying mean value of operator on both the side of equations we get</p> <p>${x_t} = \begin{bmatrix} y(t) \\ m(t) \end{bmatrix} = \begin{bmatrix} 1 &amp;1 \\ 0 &amp; 1 \end{bmatrix}.\begin{bmatrix} y(t-1) \\ m(t-1) \end{bmatrix} = Fx_{t-1} $———- <strong>(1)</strong> (mean of $v_t$ is zero)</p> <p>$z_t = \begin{bmatrix} 1 &amp; 0 \end{bmatrix}.\begin{bmatrix} y(t) \\ m(t) \end{bmatrix} = H.x_t $ ————- <strong>(2)</strong> (mean of $w_t$ is zero) F is known as state transition model .It is designed according to your system. H is observation model. So we predict our state after time t with equation 1 and the expected measurement is given buy equation 2 .But our expected measurement and true measurement will not match because if that would happen we would not need a kalman filter. Let us assume we measured some value represented by matrix ${a_t}$. Let <strong>y</strong> represent the error between them, then <strong>y</strong> = ${a_t} - z_t $</p> <p>To incorporate this into our model, we add the innovation to our state equation, multiplied by a matrix factor that tells us how much the state should change based on this difference between the expected and actual measurements. ${x_t} = Fx_{t-1} + Wy $</p> <p>W is called kalman gain. Now calculating this is the point where things become little bit confusing. Now suppose we have a high process noise , it means there is a strong tendency for the system to change rapidly. Therefore innovation should be taken seriously (means there can be difference between our predicted and measured value as system is changing rapidly). This implies W should be large and directly proportional to process noise. But if we have a high measurement noise it is not necessary that our system might have changed ,it can also be wrong data as we have high measurement noise. So W can be said to be inversely proportional to measurement noise.</p> <p><strong>W ~ (process noise)/(measurement noise)</strong></p> <p>Now we have to calculate the noises. The best way to represent the noise is variance. For calculating process noise we will take co-variance of $x_t$. $P_t$ = Cov($x_t$) = Cov($Fx_{t-1}$) =$F$.Cov($x_{t-1}$).$F^T$ =$F.P_{t-1}.F^T$ However , this assumes our process model is perfect and there’s nothing we couldn’t predict. But normally there are many unknowns that might be influencing our state (maybe there’s wind, friction etc.). We incorporate this as a covariance matrix Q of process noise $v_t$ and prediction variance becomes: $P_t = F.P_{t-1}.F^T + Q$</p> <p>Similarly for measurement noise $S_t = Cov(z_{t})$ $S_t = H.P_t.H^T + R$ So we get $ W = P_{t}.H^T.S_t^{-1}$</p> <p>One more way to understand kalman gain is that suppose we have highly faulty instruments and we can’t rely on there readings so in that case our prediction is supposed to be more accurate .Rewriting our kalman gain equation ${x_t} = Fx_{t-1} + W ({a_t} - z_t {x_t}) = Fx_{t-1} + W ({a_t} - H.F.x_{t-1}) $</p> <p>So our W should be such that $a_t$ has less weight-age and $x_{t-1}$ has more which implies that W should be small. Similarly we can show that if our measurement noise is less W should be large. Finally we have to update the error co-variance<br /> $P_t = (I - K.H).P_t$</p> <p>Summarising <img src="/img/tutorial/advanced/pic3.jpg" alt="enter image description here" class="img-responsive" /></p> <p>In the above image A is the same matrix as F that is given in the derivation above.</p> <p>The derivation that was given above is not completely mathematical but it is easy to understand and know what is happening in kalman filter.</p> <p>For proper mathematical derivation links are given below which you can refer.</p> <ul> <li><a href="https://www.academia.edu/1512888/Introduction_to_the_Kalman_Filter_and_its_Derivation">Mathemaical proof of kf : website academia.edu</a></li> <li><a href="http://users.isr.ist.utl.pt/~mir/pub/kalman.pdf">PDF of proof of kalman filter</a></li> </ul> </div> </article> </div> </div> </div> </section> <!-- End Post --> <!-- Begin Footer --> <footer id="footer" class="footer"> <div class="row"> <div class="logo logo-footer pull-right"></div> </div> <div class="row"> <div class="col-md-4 col-xs-6"> <h5>Links</h5> <ul> <li><a href="https://drive.google.com/open?id=1jNJHFE1QjGOHFwhhzn6e774odGv-6eFQ" target="_blank">Robotix App</a></li> <li><a href="https://robotix.in/event/" target="_blank">Events</a></li> <li><a href="https://robotix.in/tutorial/" target="_blank">Tutorials</a></li> </ul> </div> <div class="col-md-4 col-xs-6"> <h5>Contacts</h5> <ul> <li><a href="https://contact.robotix.in" target="_blank">Contact Us</a></li> </ul> </div> <div class="col-md-4 col-xs-6"> <h5>Archives</h5> <ul> <li><a href="https://2018.robotix.in/" target="_blank">Robotix 2018</a></li> <li><a href="https://2017.robotix.in/" target="_blank">Robotix 2017</a></li> <li><a href="https://2016.robotix.in/" target="_blank">Robotix 2016</a></li> </ul> </div> </div> <div class="row"> <div class="col-md-6 col-xs-12"> <ul class="social-links"> <li> <a href="https://plus.google.com/102868621563384739622/" target="_blank"> <svg class="icn icon-google-plus" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-google-plus"></use> </svg> </a> </li> <li> <a href="https://twitter.com/RobotixIITKgp" target="_blank"> <svg class="icn icon-twitter" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-twitter"></use> </svg> </a> </li> <li> <a href="https://facebook.com/robotixiitkgp" target="_blank"> <svg class="icn icon-facebook" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-facebook"></use> </svg> </a> </li> <li> <a href="https://www.youtube.com/robotixiitkgp" target="_blank"> <svg class="icn icon-youtube" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-youtube"></use> </svg> </a> </li> <li> <a href="/feed.xml" target="_blank"> <svg class="icn icon-rss" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-rss"></use> </svg> </a> </li> </ul> </div> </div> <div class="row"> <!-- Please don't delete this line--> <div class="col-md-6"> <p class="copyright"> &copy; 2018 Technology Robotix Society, IIT Kharagpur </p> </div> </div> </footer> <!-- End Footer --> </div> </div> </div> <!-- Begin Floating Action button--> <ul class="fab"> <li> <input type="text" class="search input-sm form-control" placeholder="Search the site..."> <button class="btn btn-danger waves-circle waves-effect waves-light waves-float rotate"> <h4 class="fab-text media-middle"><b>+</b></h4> </button> </li> </ul> <script> window.jQuery || document.write('<script src="/js/jquery-2.1.1.min.js"><\/script>') </script> <script> document.write('<script src="/js/bootstrap.min.js"><\/script>') </script> <script src="/js/default.min.js"></script> <script>Waves.displayEffect();</script> <script src="/js/scripts.min.js"></script> <script> (function(){ var handle = '@robotixiitkgp'; var a = document.createElement('script'); var m = document.getElementsByTagName('script')[0]; a.async = 1; a.src = 'https://nectar.ninja/api/v1/' + handle.slice(1); m.parentNode.insertBefore(a, m); })(); </script> <script> (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){ (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t); e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e); })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st'); _st('install','a_iioDrTs6zXmqH8x5Yr','2.0.0'); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-83617238-1', 'auto'); ga('send', 'pageview'); </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } }); </script> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> </body> </html>
