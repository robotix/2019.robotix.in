<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"> <meta name="description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur."> <meta name="keywords" content="robotix, robotics, iit, kgp, team, events, society, technology, tutorial"> <meta name="google-site-verification" content="ZR618hQWwV_OwtWa033492kzvBaQYxBc1ZauYc5oO5A" /> <!-- Social: Twitter --> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@robotixiitkgp"> <meta name="twitter:title" content="USART-UART"> <meta name="twitter:description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur."> <meta name="twitter:image:src" content="/img/favicons/favicon-196x196.png"> <!-- Social: Facebook / Open Graph --> <meta property="og:title" content="USART-UART" /> <meta property="og:site_name" content="Technology Robotix Society, IIT Kharagpur" /> <meta property="og:type" content="website" /> <meta property="og:image" content="/img/favicons/favicon-196x196.png" /> <meta property="og:description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur." /> <!-- Social: Google+ --> <link href="https://plus.google.com/102868621563384739622" rel="publisher"> <title>USART-UART &bull; Technology Robotix Society, IIT Kharagpur</title> <link rel="shortcut icon" href="/img/favicons/favicon.ico"> <link rel="apple-touch-icon" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png"> <link rel="apple-touch-icon" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png"> <link rel="apple-touch-icon" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png"> <link rel="apple-touch-icon" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png"> <link rel="apple-touch-icon" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png"> <link rel="apple-touch-icon" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png"> <link rel="apple-touch-icon" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png"> <link rel="apple-touch-icon" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-160x160.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png"> <meta name="msapplication-TileColor" content="#2b5797"> <meta name="msapplication-TileImage" content="/img/favicons/mstile-144x144.png"> <meta name="msapplication-config" content="/img/favicons/browserconfig.xml"> <meta name="theme-color" content="#2b5797"> <link href="/css/main.css" rel="stylesheet"> <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --> <!-- WARNING: Respond.js doesn't work if you view the page via file:// --> <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]--> </head> <body> <div id="st-container" class="st-container"> <div class="st-pusher"> <div class="st-content"> <!-- Begin Top Section --> <section id="top-section" class="top-section image-section " style=""> <div class="overlay gradient-overlay"></div> <header id="top-header" class="top-header"> <div class="overlay white-solid"></div> <svg id="menu-trigger" class="menu-trigger icn icon-menu visible-xs" viewBox="0 0 32 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-menu"></use> </svg> <a href="/" id="logo-header" class="logo-header"> <div class="logo"></div> </a> <nav class="st-menu st-effect" id="menu"> <div class="logo-navbar logo visible-xs"></div> <ul> <li> <a class="" href=" https://makerspace.robotix.in/" target="_blank">Makerspace</a> </li> <li> <a class="" href="/FAQs/" >FAQs</a> </li> <li> <a class="" href="/workshops/" >Workshops</a> </li> <li> <a class="" href="/event/" >Events</a> </li> <li> <a class="" href="/blog/" >Blog</a> </li> <li> <a class="" href="/tutorial" >Tutorials</a> </li> <li> <a class="" href="/team/" >Team</a> </li> <li> <a class="" href="/about-us/" >About Us</a> </li> </ul> <ul id="bottom-navlinks" class="bottom-navlinks visible-xs"> <li> <a href="https://contact.robotix.in" target="_blank">Contact Us</a> </li> </ul> </nav> </header> <div class="content-wrapper"> <div class="jumbotron text-left"> <div class="animated hiding" data-animation="fadeInLeft" data-delay="500"> <h1>USART-UART</h1> </div> </div> </div> </section> <!-- End Top Section --> <!-- Begin Post--> <section id="post-section" class="post-section"> <div class="content-wrapper text-left"> <div class="col-md-10 col-sm-10 col-lg-offset-2 col-md-offset-2 col-sm-offset-1"> <div class="col-lg-8 col-md-10 col-xs-12"> <article class="row post"> <div class="post-body"><h4 id="introduction">Introduction</h4> <p><strong>USART **stands for “</strong>Universal Synchronous Asynchronous Receiver and Transmitter**”.</p> <p>It is a mode of communication between devices which is <strong>serial **in nature, i.e. data units, say a byte is transmitted **one bit at a time</strong>. This is unlike parallel modes of transmission where entire data unit, say a byte (8 bits) is transmitted at once.</p> <p><strong><img src="https://docs.google.com/drawings/image?id=slvYquHXgUeM4iu0DpvfvgQ&amp;w=610&amp;h=162&amp;rev=37&amp;ac=1" alt="" /></strong></p> <p>There are <strong>two data lines, RX and TX</strong>, which stand for receiver and transmitter, <strong>relative to a device</strong>.** In normal microcontroller circuits the TTL (Transistor-Transistor Logic) standard** for serial communication is used, where High = +5V, Low = 0V. But <strong>computers use RS232 communication standard</strong>, the protocol which specifies High = -12V, Low = +12V. This conversion is achieved through a <strong>MAX232 integrated circuit</strong>. You can <strong>make the converter</strong> yourself, as detailed below, or you can <strong>buy direct USB-to-USART</strong> connectors.</p> <h4 id="level-conversion-circuit">Level Conversion Circuit</h4> <p>Components</p> <table> <thead> <tr> <th>S.No.</th> <th>Item</th> <th>Quantity</th> <th>Rating</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>MAX232 IC</td> <td>1</td> <td> </td> </tr> <tr> <td>2</td> <td>Capacitors</td> <td>4</td> <td>1uF</td> </tr> <tr> <td>3</td> <td>Capacitors</td> <td>1</td> <td>10uF</td> </tr> <tr> <td>4</td> <td>DB9 Female Connector</td> <td>1</td> <td> </td> </tr> <tr> <td>5</td> <td>Small PCB</td> <td>1</td> <td> </td> </tr> <tr> <td>6</td> <td>USB to Serial Converter</td> <td>1</td> <td> </td> </tr> </tbody> </table> <p> </p> <p> </p> <p> </p> <p> </p> <p> </p> <p> </p> <p><strong><img src="https://lh3.googleusercontent.com/HQzmQjHO3DndpVzqQg89hUX0opwL0BEbIcdgEN3N0SrxzkAW57tDe5eZcvvIHmSfU3ETnTTSrbrvPMNSQ_qdCh5Ra4klcv7jzVMGS1OVKwrt3mULGVY" alt="" /><img src="https://lh4.googleusercontent.com/QFX0a7LtoebctZ__9JGofxk6d1ZWVkVd1A0BwRz6Kh34y56uDpI6EWEZk8VKnekIiKXIQS-lkz3L2dPGJFkNWcBd4eB8A7UeStQb7onw0A3y-oz7xh8" alt="" /></strong></p> <p><strong><img src="https://lh4.googleusercontent.com/ycy-4nB7P8hulU9kHrA5AAp1E3hShatCMKRDso2mVhrQGb9wvrfC9ivPdBiSYyGhmhS_UvmFdcChQ6jZ09TgepTPlHtwOUcGouKW-I5gMrYs2IQZBeY" alt="" /></strong></p> <p>The actual bit-level explanation of data transfer through USART is beyond the scope of this tutorial. We are more interested in the <strong>ways to use it through an AVR Microcontroller</strong>. The microcontroller has special hardware which can handle the USART module once the data to be transmitted has been sent to it.</p> <h4 id="usart-registers">USART Registers</h4> <p>The settings to use the USART module is set using certain registers, the information about which is provided in the microcontroller datasheet.</p> <ul> <li><strong>UDR : USART Data Register :</strong> contains the received data or the transmitted data.</li> <li><strong>UCSRA / UCSRB / UCSRC : USART Control and Status Registers :</strong> used to configure the USART, also stores some status about it.</li> <li>**UBRRH / UBRRL : USART Baud Rate Register : **stores a value corresponding the baud rate used. The **baud rate measures the speed of data transmission **in bits per second. We shall use a standard rate of 9600 baud here.</li> </ul> <p>The individual bits in the registers are explained now. Bits of interest are highlighted in bold:</p> <p><em><strong>UCSRA: USART Control and Status Register A:</strong></em></p> <table> <tbody> <tr> <td>Bit No.</td> <td><strong>7</strong></td> <td><strong>6</strong></td> <td>5</td> <td>4</td> <td>3</td> <td>2</td> <td>1</td> <td>0</td> </tr> <tr> <td>Name</td> <td><strong>RXC</strong></td> <td><strong>TXC</strong></td> <td>UDRE</td> <td>FE</td> <td>DOR</td> <td>PE</td> <td>U2X</td> <td>MPCM</td> </tr> </tbody> </table> <p>**RXC : **set when the USART has completed receiving a byte from the host (may be your PC) and the program should read it from UDR<br /> **TXC : **set when the USART has completed transmitting a byte to the host and your program can write new data to USART via UDR</p> <p><em><strong>UCSRB: USART Control and Status Register B:</strong></em></p> <table> <tbody> <tr> <td>Bit No.</td> <td><strong>7</strong></td> <td><strong>6</strong></td> <td>5</td> <td><strong>4</strong></td> <td><strong>3</strong></td> <td><strong>2</strong></td> <td>1</td> <td>0</td> </tr> <tr> <td>Name</td> <td><strong>RXCIE</strong></td> <td><strong>TXCIE</strong></td> <td>UDRIE</td> <td><strong>RXEN</strong></td> <td><strong>TXEN</strong></td> <td><strong>UCSZ2</strong></td> <td>RXB8</td> <td>TXB8</td> </tr> </tbody> </table> <p><strong>RXCIE: Receive Complete Interrupt Enable **- when one, the the associated interrupt is enabled.<br /> **TXCIE: Transmit Complete Interrupt Enable</strong> - when one, the the associated interrupt is enabled.<br /> <strong>RXEN: Receiver Enable - **when one, the USART receiver is enabled.<br /> **TXEN: Transmitter Enable</strong> -when one, the USART transmitter is enabled.<br /> <strong>UCSZ2: USART Character Size</strong> - Discussed later.</p> <p><em><strong>UCSRC: USART Control and Status Register C:</strong></em></p> <table> <tbody> <tr> <td>Bit No.</td> <td><strong>7</strong></td> <td><strong>6</strong></td> <td>5</td> <td>4</td> <td>3</td> <td><strong>2</strong></td> <td><strong>1</strong></td> <td>0</td> </tr> <tr> <td>Name</td> <td><strong>URSEL</strong></td> <td><strong>UMSEL</strong></td> <td>UPM1</td> <td>UPM0</td> <td>USBS</td> <td><strong>UCSZ1</strong></td> <td><strong>UCSZ0</strong></td> <td>UCPOL</td> </tr> </tbody> </table> <p><strong>IMPORTANT **: The UCSRC and the UBRRH (discussed below) register shares same address so to determine which register user want to write is decided with the 7th(last) bit of data if its 1 then the data is written to UCSRC else it goes to UBRRH. This seventh bit is called the </strong>URSEL: USART Register Select.**<br /> <strong>UMSEL: USART Mode Select -</strong> This bit selects between asynchronous and synchronous mode. As asynchronous mode is more popular with USART we will be using that. 0 =asynchronous, 1 = synchronous<br /> **UCSZ: USART Character size **- These three bits (one in the UCSRB) selects the number of bits of data that is transmited in each frame. Normally the unit of data in MCU is 8BIT (C type “char”) and this is most widely used so we will go for this. Otherwise you can select 5,6,7,8 or 9 bit frames.</p> <p><em><strong>UBRR: USART Baud Rate Register</strong></em></p> <p>This register is 16BIT wide so **UBRRH **is the High Byte and **UBRRL **is Low byte. But as we are using C language it is directly available as UBRR and compiler manages the 16BIT access. This register is used by the USART to generate the data transmission at specified speed (say 9600Bps). UBRR value is calculated according to following formula:</p> <p><strong><img src="https://lh4.googleusercontent.com/1hOAVMtlBCCCWV6x1Ew_ZKn9H_K1Z1OOKK_YufokmXQLHQ2VDFY_Fv6ztcBmkZEzNcLh-YrQg7BmInjl58EybrG81_f50fPXQFH-FsFF9X9BNrYyUbI" alt="" /></strong></p> <p>Where fosc is your CPU frequency say 16MHz. For a frequency of 16 MHz and baud rate of 9600, the UBRR value should be 103.</p> <p> </p> <h4 id="sample-avr-code">Sample AVR Code</h4> <p>Make sure you understand this code and then burn it on the microcontroller. <strong>Use C9 and FF as the fuse bits (high and low).</strong></p> <h4 id="sample-sender-code">Sample Sender Code</h4> <p>Now we will make a** C++ program to send data through the USB wire and MAX232 circuit **to the microcontroller, so that the corresponding combination of LEDs are lit up. We will include some files in our program to make the sender program simple.</p> <p>These are:</p> <ol> <li><a href="http://robotix.in/samplecode/tserial.h"><strong>tserial.h</strong> </a>– A header file for starting the serial device</li> <li><a href="http://robotix.in/samplecode/tserial.cpp"><strong>tserial.cpp</strong></a> – The C++ program that actually initializes the device</li> <li><a href="http://robotix.in/samplecode/bot_control.h"><strong>bot_control.h</strong></a> – The file which contains the definitions of the functions which shall be used for the purpose of serial communication [send_data(), startDevice(), stopDevice() etc]</li> </ol> <p>Download these files and include them in your sender program.</p> <ul> <li>The object comm is of the class serial, which is defined in the bot_control.h file. This <strong>class has the member functions which we need to access for starting and closing the communication device, as well as sending data among other tasks.</strong></li> <li>The **COM port can be found out by going to the Device Manager **and checking the specifications of the device from there (usually under the Ports drop down). The second parameter is an integer which is the baud-rate or the data transfer rate for the communication protocol.</li> </ul> </div> </article> </div> </div> </div> </section> <!-- End Post --> <!-- Begin Footer --> <footer id="footer" class="footer"> <div class="row"> <div class="logo logo-footer pull-right"></div> </div> <div class="row"> <div class="col-md-4 col-xs-6"> <h5>Links</h5> <ul> <li><a href="https://drive.google.com/open?id=1jNJHFE1QjGOHFwhhzn6e774odGv-6eFQ" target="_blank">Robotix App</a></li> <li><a href="https://robotix.in/event/" target="_blank">Events</a></li> <li><a href="https://robotix.in/tutorial/" target="_blank">Tutorials</a></li> </ul> </div> <div class="col-md-4 col-xs-6"> <h5>Contacts</h5> <ul> <li><a href="https://contact.robotix.in" target="_blank">Contact Us</a></li> </ul> </div> <div class="col-md-4 col-xs-6"> <h5>Archives</h5> <ul> <li><a href="https://2018.robotix.in/" target="_blank">Robotix 2018</a></li> <li><a href="https://2017.robotix.in/" target="_blank">Robotix 2017</a></li> <li><a href="https://2016.robotix.in/" target="_blank">Robotix 2016</a></li> </ul> </div> </div> <div class="row"> <div class="col-md-6 col-xs-12"> <ul class="social-links"> <li> <a href="https://plus.google.com/102868621563384739622/" target="_blank"> <svg class="icn icon-google-plus" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-google-plus"></use> </svg> </a> </li> <li> <a href="https://twitter.com/RobotixIITKgp" target="_blank"> <svg class="icn icon-twitter" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-twitter"></use> </svg> </a> </li> <li> <a href="https://facebook.com/robotixiitkgp" target="_blank"> <svg class="icn icon-facebook" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-facebook"></use> </svg> </a> </li> <li> <a href="https://www.youtube.com/robotixiitkgp" target="_blank"> <svg class="icn icon-youtube" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-youtube"></use> </svg> </a> </li> <li> <a href="/feed.xml" target="_blank"> <svg class="icn icon-rss" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-rss"></use> </svg> </a> </li> </ul> </div> </div> <div class="row"> <!-- Please don't delete this line--> <div class="col-md-6"> <p class="copyright"> &copy; 2018 Technology Robotix Society, IIT Kharagpur </p> </div> </div> </footer> <!-- End Footer --> </div> </div> </div> <!-- Begin Floating Action button--> <ul class="fab"> <li> <input type="text" class="search input-sm form-control" placeholder="Search the site..."> <button class="btn btn-danger waves-circle waves-effect waves-light waves-float rotate"> <h4 class="fab-text media-middle"><b>+</b></h4> </button> </li> </ul> <script> window.jQuery || document.write('<script src="/js/jquery-2.1.1.min.js"><\/script>') </script> <script> document.write('<script src="/js/bootstrap.min.js"><\/script>') </script> <script src="/js/default.min.js"></script> <script>Waves.displayEffect();</script> <script src="/js/scripts.min.js"></script> <script> (function(){ var handle = '@robotixiitkgp'; var a = document.createElement('script'); var m = document.getElementsByTagName('script')[0]; a.async = 1; a.src = 'https://nectar.ninja/api/v1/' + handle.slice(1); m.parentNode.insertBefore(a, m); })(); </script> <script> (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){ (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t); e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e); })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st'); _st('install','a_iioDrTs6zXmqH8x5Yr','2.0.0'); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-83617238-1', 'auto'); ga('send', 'pageview'); </script> </body> </html>
