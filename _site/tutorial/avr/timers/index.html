<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"> <meta name="description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur."> <meta name="keywords" content="robotix, robotics, iit, kgp, team, events, society, technology, tutorial"> <meta name="google-site-verification" content="ZR618hQWwV_OwtWa033492kzvBaQYxBc1ZauYc5oO5A" /> <!-- Social: Twitter --> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@robotixiitkgp"> <meta name="twitter:title" content="Timers"> <meta name="twitter:description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur."> <meta name="twitter:image:src" content="/img/favicons/favicon-196x196.png"> <!-- Social: Facebook / Open Graph --> <meta property="og:title" content="Timers" /> <meta property="og:site_name" content="Technology Robotix Society, IIT Kharagpur" /> <meta property="og:type" content="website" /> <meta property="og:image" content="/img/favicons/favicon-196x196.png" /> <meta property="og:description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur." /> <!-- Social: Google+ --> <link href="https://plus.google.com/102868621563384739622" rel="publisher"> <title>Timers &bull; Technology Robotix Society, IIT Kharagpur</title> <link rel="shortcut icon" href="/img/favicons/favicon.ico"> <link rel="apple-touch-icon" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png"> <link rel="apple-touch-icon" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png"> <link rel="apple-touch-icon" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png"> <link rel="apple-touch-icon" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png"> <link rel="apple-touch-icon" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png"> <link rel="apple-touch-icon" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png"> <link rel="apple-touch-icon" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png"> <link rel="apple-touch-icon" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-160x160.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png"> <meta name="msapplication-TileColor" content="#2b5797"> <meta name="msapplication-TileImage" content="/img/favicons/mstile-144x144.png"> <meta name="msapplication-config" content="/img/favicons/browserconfig.xml"> <meta name="theme-color" content="#2b5797"> <link href="/css/main.css" rel="stylesheet"> <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --> <!-- WARNING: Respond.js doesn't work if you view the page via file:// --> <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]--> </head> <body> <div id="st-container" class="st-container"> <div class="st-pusher"> <div class="st-content"> <!-- Begin Top Section --> <section id="top-section" class="top-section image-section " style=""> <div class="overlay gradient-overlay"></div> <header id="top-header" class="top-header"> <div class="overlay white-solid"></div> <svg id="menu-trigger" class="menu-trigger icn icon-menu visible-xs" viewBox="0 0 32 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-menu"></use> </svg> <a href="/" id="logo-header" class="logo-header"> <div class="logo"></div> </a> <nav class="st-menu st-effect" id="menu"> <div class="logo-navbar logo visible-xs"></div> <ul> <li> <a class="" href=" https://makerspace.robotix.in/" target="_blank">Makerspace</a> </li> <li> <a class="" href="/FAQs/" >FAQs</a> </li> <li> <a class="" href="/workshops/" >Workshops</a> </li> <li> <a class="" href="/event/" >Events</a> </li> <li> <a class="" href="/blog/" >Blog</a> </li> <li> <a class="" href="/tutorial" >Tutorials</a> </li> <li> <a class="" href="/team/" >Team</a> </li> <li> <a class="" href="/about-us/" >About Us</a> </li> </ul> <ul id="bottom-navlinks" class="bottom-navlinks visible-xs"> <li> <a href="https://contact.robotix.in" target="_blank">Contact Us</a> </li> </ul> </nav> </header> <div class="content-wrapper"> <div class="jumbotron text-left"> <div class="animated hiding" data-animation="fadeInLeft" data-delay="500"> <h1>Timers</h1> </div> </div> </div> </section> <!-- End Top Section --> <!-- Begin Post--> <section id="post-section" class="post-section"> <div class="content-wrapper text-left"> <div class="col-md-10 col-sm-10 col-lg-offset-2 col-md-offset-2 col-sm-offset-1"> <div class="col-lg-8 col-md-10 col-xs-12"> <article class="row post"> <div class="post-body"><h4 id="introduction">Introduction</h4> <p>The atmega16 provides you with two 8-bit timers and one 16-bit timer. Each timer has different modes of operations:<br /> ·         Normal Mode<br /> ·         Fast PWM<br /> ·         Phase Correct PWM<br /> ·         Clear Timer on Compare Match (CTC) Mode<br /> For the convenience of understanding only Timer0 and Timer2 are covered in this tutorial. Both of these are 8-bit Timers.</p> <h4 id="how-timer-works">How timer works</h4> <p>Since we know that atmega16 is a 8-bit microcontroller. So, everything in atmega16 is controlled by 8-bit registers. The atmega16 keeps the track of time using the TCNTn (Timer/Counter Register, where ‘n’ is either 0 or 2 depending on which timer you are using). In TCNT, each increment corresponds to one Timer Clock Cycle. The Frequency of Timer Clock Cycles is decided by crystal oscillator and the Pre-scaling factor which we can set using the register TCCRn (Timer/Counter Control Register).<br /> Microcontroller has its own frequency of operations (number of operations carried out in 1 sec).<br /> clkIO is the clock frequency of the microcontroller itself (if microcontroller is working on a frequency of 16MHz then the value of clkIO = 16 MHz). By pre-scaling we actually adjust the frequency of counts per second. So, if the pre-scaling factor is chosen to be 64 then the frequency of timer will be 16MHz/64. So, 16000000/64 counts of TCNT will result into 1 second for the above case.<br /> Note: Here, ‘n’ can be only 0 or 2 as Timer0 and Timer2 are 8-bit timers and Timer1 is 16-bit timer. 16-bit Timer is explained in the next tutorial.</p> <h4 id="modes-of-operation">Modes of Operation</h4> <p><strong>1.      Normal Mode :</strong><br /> This is the simplest mode of operation. For 8-bit timer TCNT register starts from BOTTOM (0) and counts till TOP (255). At any point of time you can initialise the value of TCNT according to your wish and note the value of TCNT at other point of time. By this you can measure the time taken by the atmega16 to do the operation.<br /> Example: if you want to measure the time taken by the atmega16 to multiply two 3-digit integers.<br /> PSUDO CODE:<br /> TCNT0 = 0;<br /> unsigned int product = 345*287;//Multiplication of two random 3-digit numbers<br /> unsigned char time = TCNT;//Now time is the number of Timer Clock Cycles<br /> //Multiplying time by the appropriate value of time for each Timer Clock Cycle (in microseconds) we calculate the time taken for the operation in microseconds.</p> <p>The next three modes require one more topic to be covered and that is PWM(Pulse Width Modulation)</p> <p><strong>Pulse Width Modulation – PWM :</strong><br /> As the name suggest we can get a hint that there is a Pulse which is generated here. To understand this concept I will consider a Pulse a square wave of voltage vs time.</p> <p><img src="https://lh3.googleusercontent.com/IZuu_j4XrZPemXTW_jydHL16q6SMQ_axOR4na2bWvgpHFpxodhVxpOiKuQYpqZwBss2Fp3A-525vVCWR4kst0yWrmZUW3yDm7HN6agMCuUwwtpqiG8pRpZzzrg" alt="" /></p> <p>Now what does Width Modulation mean. It means adjusting the time for which the source voltage will be HIGH and the time for which the source Voltage will be LOW.<br /> We can control the Width Modulation by using the two properties of this Pulse<br /> ·         Frequency<br /> ·         Duty Cycle</p> <p><em>Frequency :</em><br /> The frequency is the time period of the Square Wave. Time period correspond to the time for one voltage cycle(HIGH to HIGH). If we half the frequency, the time period of one oscillation becomes doubled. So, you can see that is the graph when we adjust the frequency the width of the oscillation can be adjusted.</p> <p><em>Duty Cycle :</em><br /> Duty Cycle is the percentage of time in a time period for which the Voltage is HIGH. The pulse given in the figure suggests that for half of the time the Voltage is HIGH and for the Rest half the Voltage is LOW. So, the duty cycle of the Pulse in the given diagram is 50%.</p> <p><img src="https://lh4.googleusercontent.com/jPZeeoHdAZ1mPe3NBmwdip0WNSQj7IlhmCU_BnlwXDl8xOEdzjnad1PF6SE66iPF3jLIefydvjxJGwh5xMCbtFLZBcxylqK5NC3kGDDxzjvmLYwH4TVwFvFnZA" alt="" /></p> <p>In the Above diagram we can see that by adjusting Duty Cycle we can control the Width Modulation<br /> So, this was the explanation of Pulse Width Modulation in short. Now continuing with modes of operation.</p> <p><strong>2.      Clear Timer on Compare Match Mode(CTC) :</strong><br /> In this mode you can set the value of the TOP. So if you set the value of TOP as 100 instead of 255(default TOP value), the TCNT counts from BOTTOM (0) to 100 and then again drops to BOTTOM (0). So, if the counts of TCNT decrease then the time period of the oscillation decreases. So, in this mode we can adjust the frequency of the. For Adjusting the TOP value in this case we use the OCRn (Output Compare Register). In this mode the OCn pin(for 8-bit timers, OC0 and OC2) is the output pin for PWM.</p> <p> </p> <p><img src="https://lh6.googleusercontent.com/-qK9ZCSrsIsBVC_nn4ZPPVjqqw_L--eV39ji4EAMaJZDMyqPFg2MYb30C9eFVP00wu7zbUc2ex2Ab7d0mOqltCMdr10jHx-oCgujuhEsDfjqg0Ukdxbs2EqZjA" alt="" /></p> <p><strong>3.      FAST PWM Mode :</strong><br /> In this mode the OCn pin(for 8-bit timers, OC0 and OC2) is the output pin for PWM of duty-cycle dependent on the value of OCRn register. The TCNT value goes from BOTTOM(0) to TOP(255). When the value of TCNT matches with that of the OCR register, the OC pin can be reset/set according to the mode selected (non-inverting/ inverting). The diagram for How Fast PWM works is given below</p> <p><img src="https://lh3.googleusercontent.com/tGwMNSzy4B_7iZxzOEjLFKKNREvc9Fp8UTN_cv4_9U5rMXj18f781dHwr_ADayXD_QCBPj5sHz0P2cXpY2r-UOp194CxOSbqZCc3kpM-D99KVRWhm7yfjdVF2A" alt="" /></p> <p>Example : If you want the output PWM to be of 25% PWM then the TCNT should count from 0 to 63(256/4). So we will initialise the value of OCRn to 63. Now, for non-inverting mode, TCNT starts counting from 0. When value of TCNTn is less than OCRn the Output is HIGH at OCn pin and when TCNTn becomes greater than OCRn value then the Output is LOW at OCn pin. When TCNTn overflows(When there is a transition from MAX to BOTTOM) , the output again becomes HIGH and the cycle continues. So, we can see that for the above case the outut of OCn for one time period remains HIGH for only 1/4th of the time period. So, the duty cycle for the above case is 25%.</p> <p><strong>4.      Phase Correct PWM :</strong><br /> In this mode the TCNT increases from BOTTOM to MAX and then falls from MAX to BOTTOM. So in this case the duty cycle will remain same as that in the case of the Fast PWM but frequency is halved.</p> <p><img src="https://lh6.googleusercontent.com/-DqGjjqpIFo9VXBQp07CkYuLyvD96F3dMqVHL_7THZFmfU7DT-UHHg5f_ro1EniT8AAB4IFoKNcVy5xkroYJo8hBjAawrV7FBiNadWHNTeI6Di2TfCMqsC2sFQ" alt="" /></p> <h4 id="tccr-registers">TCCR Registers</h4> <p><img src="https://lh3.googleusercontent.com/bvMgqJbXiqAR45CY7TSNVoWfY5VTwentfFqXX8LBtfECXOGHaJfJwcT8nA6e640UydIm55lAMheLAe4HAqiNTLSdTlIcDpp_b1moWDLHiuSN97s4zUmwxHGpmQ" alt="" /></p> <p>This bit is not required .So we will set it to 0.</p> <p><strong>Bit 6,3 - WGM01:0: Wave form Generation Mode</strong><br /> These two bits will decide the mode of Timer according to the table shown below</p> <p><img src="https://lh6.googleusercontent.com/2s_L5o1U40iKQMAQm2cntzFsWfLSFVGsRp_8XLHTaRKwCxN3rlcWLrPhwmtQq1SPrc-DmjempmsXLTsDap1hL08Ar0qnPMfWpsSrFVX8nd9TIfyJdhpcF2EmPQ" alt="" /></p> <p><strong>Bit 5,4 - COM01:0: Compare Match Output Mode :</strong></p> <p><strong><img src="https://lh6.googleusercontent.com/GwwTH-OhZMXhhLZwgmFSMqY8mpSB1WE-CBvI4Tb2wPrN8Qif2txgTmGn3XVgs05rpG13XuSHapGTvIjt-ZUk4kGNF0KyIeVpEA4H85TNiEpiOtSMhWau86vfXA" alt="" /></strong></p> <p><strong>Table 39 shows the COM01:0 bit functionality when the WGM01:0 bits are set to a</strong></p> <p><strong>normal or CTC mode (non-PWM).</strong></p> <p>·   In first case only timer will be generated and no PWM output will be generated at the OCn pin</p> <p>·   In second case for one time period the OCn pin will be HIGH and for the succeeding time period the value of OCn pin will be LOW.<br /> Clear means setting the Output to LOW</p> <p>Set means setting the Output to HIGH</p> <p><img src="https://lh3.googleusercontent.com/bR6V2vJDHQlA09Uns_L6tfm_9HlhBFEw7b2CUdmAIUzZTvwuXiFhTnAOK01gSDqKZfhEbg3TxJWCnX3jvWkcw9SEk_BJfsapV3eC_QaSDG4TMOQ912oLLdKVUQ" alt="" /></p> <p><strong>Table 40 shows the COM01:0 bit functionality when the WGM01:0 bits are set to fast PWM mode.</strong></p> <p>·         In first case no Output will be generated on OCn pin</p> <p>·         Second case is reserved. It will not serve our purpose<br /> ·         Third case will generate a PWM of duty cycle depending upon the value of OCRn and in non-inverting mode<br /> ·         Fourth case will generate a PWM of duty cycle depending upon the value of OCRn and in inverting mode</p> <p><img src="https://lh3.googleusercontent.com/o3WgTYXZZARmITn-2R3mh877m-MKLqYFVN_MK9DL9I4gnkZZsUlzYVCfddJ97UH3ZUexI4gTX9Uye6DfV0Um61TIlGNBZu8tx8lqMMeXzj4sKC3XZtQeN0Fl_Q" alt="" /></p> <p><strong>Table 41 shows the COM01:0 bit functionality when the WGM01:0 bits are set to phase correct PWM mode.</strong></p> <p>·         In first case no Output will be generated on OCn pin</p> <p>·         Second case is reserved. It will not serve our purpose<br /> ·         Third case will generate a PWM of duty cycle depending upon the value of OCRn and in non-inverting mode<br /> ·         Fourth case will generate a PWM of duty cycle depending upon the value of OCRn and in inverting mode</p> <p><strong>·         Bit 2:0 – CS02:0: Clock Select</strong><br /> Microcontroller has its own frequency of operations (number of operations carried out in 1 sec).<br /> clkIO is the clock frequency of the microcontroller itself (if microcontroller is working on a frequency of 16MHz then the value of clkIO = 16 MHz). By pre-scaling we actually adjust the frequency of counts per second. So, if the pre-scaling factor is chosen to be 64 then the frequency of timer will be 16MHz/64.</p> <p><img src="https://lh6.googleusercontent.com/78cZ7I_29s2tudw_OCJhcCtYLImPDykYzg-mEDI6wRCyXub4v75r38CuxBGuqo35oxAB-GWTJt64xsKDWJIWLiygpx0GXoqentOyaiZDTAjl1CLQktSmSO2dXA" alt="" /></p> <p><strong>Table 42 shows the prescaling factor for the different values of bits CS02:0</strong></p> <h4 id="code">Code</h4> </div> </article> </div> </div> </div> </section> <!-- End Post --> <!-- Begin Footer --> <footer id="footer" class="footer"> <div class="row"> <div class="logo logo-footer pull-right"></div> </div> <div class="row"> <div class="col-md-4 col-xs-6"> <h5>Links</h5> <ul> <li><a href="https://drive.google.com/open?id=1jNJHFE1QjGOHFwhhzn6e774odGv-6eFQ" target="_blank">Robotix App</a></li> <li><a href="https://robotix.in/event/" target="_blank">Events</a></li> <li><a href="https://robotix.in/tutorial/" target="_blank">Tutorials</a></li> </ul> </div> <div class="col-md-4 col-xs-6"> <h5>Contacts</h5> <ul> <li><a href="https://contact.robotix.in" target="_blank">Contact Us</a></li> </ul> </div> <div class="col-md-4 col-xs-6"> <h5>Archives</h5> <ul> <li><a href="https://2018.robotix.in/" target="_blank">Robotix 2018</a></li> <li><a href="https://2017.robotix.in/" target="_blank">Robotix 2017</a></li> <li><a href="https://2016.robotix.in/" target="_blank">Robotix 2016</a></li> </ul> </div> </div> <div class="row"> <div class="col-md-6 col-xs-12"> <ul class="social-links"> <li> <a href="https://plus.google.com/102868621563384739622/" target="_blank"> <svg class="icn icon-google-plus" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-google-plus"></use> </svg> </a> </li> <li> <a href="https://twitter.com/RobotixIITKgp" target="_blank"> <svg class="icn icon-twitter" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-twitter"></use> </svg> </a> </li> <li> <a href="https://facebook.com/robotixiitkgp" target="_blank"> <svg class="icn icon-facebook" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-facebook"></use> </svg> </a> </li> <li> <a href="https://www.youtube.com/robotixiitkgp" target="_blank"> <svg class="icn icon-youtube" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-youtube"></use> </svg> </a> </li> <li> <a href="/feed.xml" target="_blank"> <svg class="icn icon-rss" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-rss"></use> </svg> </a> </li> </ul> </div> </div> <div class="row"> <!-- Please don't delete this line--> <div class="col-md-6"> <p class="copyright"> &copy; 2018 Technology Robotix Society, IIT Kharagpur </p> </div> </div> </footer> <!-- End Footer --> </div> </div> </div> <!-- Begin Floating Action button--> <ul class="fab"> <li> <input type="text" class="search input-sm form-control" placeholder="Search the site..."> <button class="btn btn-danger waves-circle waves-effect waves-light waves-float rotate"> <h4 class="fab-text media-middle"><b>+</b></h4> </button> </li> </ul> <script> window.jQuery || document.write('<script src="/js/jquery-2.1.1.min.js"><\/script>') </script> <script> document.write('<script src="/js/bootstrap.min.js"><\/script>') </script> <script src="/js/default.min.js"></script> <script>Waves.displayEffect();</script> <script src="/js/scripts.min.js"></script> <script> (function(){ var handle = '@robotixiitkgp'; var a = document.createElement('script'); var m = document.getElementsByTagName('script')[0]; a.async = 1; a.src = 'https://nectar.ninja/api/v1/' + handle.slice(1); m.parentNode.insertBefore(a, m); })(); </script> <script> (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){ (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t); e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e); })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st'); _st('install','a_iioDrTs6zXmqH8x5Yr','2.0.0'); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-83617238-1', 'auto'); ga('send', 'pageview'); </script> </body> </html>
