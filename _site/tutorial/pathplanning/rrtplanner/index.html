<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"> <meta name="description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur."> <meta name="keywords" content="robotix, robotics, iit, kgp, team, events, society, technology, tutorial"> <meta name="google-site-verification" content="ZR618hQWwV_OwtWa033492kzvBaQYxBc1ZauYc5oO5A" /> <!-- Social: Twitter --> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@robotixiitkgp"> <meta name="twitter:title" content="RRT Path Planning"> <meta name="twitter:description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur."> <meta name="twitter:image:src" content="/img/favicons/favicon-196x196.png"> <!-- Social: Facebook / Open Graph --> <meta property="og:title" content="RRT Path Planning" /> <meta property="og:site_name" content="Technology Robotix Society, IIT Kharagpur" /> <meta property="og:type" content="website" /> <meta property="og:image" content="/img/favicons/favicon-196x196.png" /> <meta property="og:description" content="Technology Robotix Society is an official society under the Technology Students' Gymkhana IIT Kharagpur." /> <!-- Social: Google+ --> <link href="https://plus.google.com/102868621563384739622" rel="publisher"> <title>RRT Path Planning &bull; Technology Robotix Society, IIT Kharagpur</title> <link rel="shortcut icon" href="/img/favicons/favicon.ico"> <link rel="apple-touch-icon" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png"> <link rel="apple-touch-icon" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png"> <link rel="apple-touch-icon" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png"> <link rel="apple-touch-icon" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png"> <link rel="apple-touch-icon" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png"> <link rel="apple-touch-icon" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png"> <link rel="apple-touch-icon" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png"> <link rel="apple-touch-icon" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-160x160.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png"> <meta name="msapplication-TileColor" content="#2b5797"> <meta name="msapplication-TileImage" content="/img/favicons/mstile-144x144.png"> <meta name="msapplication-config" content="/img/favicons/browserconfig.xml"> <meta name="theme-color" content="#2b5797"> <link href="/css/main.css" rel="stylesheet"> <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --> <!-- WARNING: Respond.js doesn't work if you view the page via file:// --> <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]--> </head> <body> <div id="st-container" class="st-container"> <div class="st-pusher"> <div class="st-content"> <!-- Begin Top Section --> <section id="top-section" class="top-section image-section " style=""> <div class="overlay gradient-overlay"></div> <header id="top-header" class="top-header"> <div class="overlay white-solid"></div> <svg id="menu-trigger" class="menu-trigger icn icon-menu visible-xs" viewBox="0 0 32 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-menu"></use> </svg> <a href="/" id="logo-header" class="logo-header"> <div class="logo"></div> </a> <nav class="st-menu st-effect" id="menu"> <div class="logo-navbar logo visible-xs"></div> <ul> <li> <a class="" href=" https://makerspace.robotix.in/" target="_blank">Makerspace</a> </li> <li> <a class="" href="/FAQs/" >FAQs</a> </li> <li> <a class="" href="/workshops/" >Workshops</a> </li> <li> <a class="" href="/event/" >Events</a> </li> <li> <a class="" href="/blog/" >Blog</a> </li> <li> <a class="" href="/tutorial" >Tutorials</a> </li> <li> <a class="" href="/team/" >Team</a> </li> <li> <a class="" href="/about-us/" >About Us</a> </li> </ul> <ul id="bottom-navlinks" class="bottom-navlinks visible-xs"> <li> <a href="https://contact.robotix.in" target="_blank">Contact Us</a> </li> </ul> </nav> </header> <div class="content-wrapper"> <div class="jumbotron text-left"> <div class="animated hiding" data-animation="fadeInLeft" data-delay="500"> <h1>RRT Path Planning</h1> </div> </div> </div> </section> <!-- End Top Section --> <!-- Begin Post--> <section id="post-section" class="post-section"> <div class="content-wrapper text-left"> <div class="col-md-10 col-sm-10 col-lg-offset-2 col-md-offset-2 col-sm-offset-1"> <div class="col-lg-8 col-md-10 col-xs-12"> <article class="row post"> <div class="post-body"><h5 id="introduction">Introduction</h5> <p>A Rapidly-Exploring Random Tree is a randomised data structure that is designed for path planning problems.</p> <h5 id="algorithm">Algorithm</h5> <p>In any image where RRT has to be implemented, there will be a start point, an end point and obstacles. The start point is taken as the first node, and the end point is taken as the last node. The first step is to generate a random node. Using distance formula, the node (in the tree) which has the minimum distance from this random node among all other nodes in the tree is identified. Starting from the nearest node, in the direction of the random node, a new node is generated at a predefined distance called step size. This new node is then added to the tree. These steps are repeated n number of times till the end point is added to the tree. Then a continuous path is traced from the start point to the end point which successfully avoids all obstacles. This process results into a tree-like structure, hence the name Rapidly-Exploring Random Tree.</p> <h5 id="the-code-explained">The code explained</h5> <p>Let us take a sample image to implement the code on.</p> <p><img src="/img/tutorial/pathplanning/rrt/rrt1.png" alt="original image" class="img-responsive" /></p> <p>Following are some basic declarations:</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span><span class="n">coordi</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">Node</span>
<span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">Node</span> <span class="o">*&gt;</span> <span class="n">children</span><span class="p">;</span>
	<span class="n">Node</span> <span class="o">*</span><span class="n">parent</span><span class="p">;</span>
	<span class="n">coordi</span> <span class="n">position</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Node</span> <span class="n">start_node</span><span class="p">;</span>
<span class="n">Node</span> <span class="n">end_node</span><span class="p">;</span>
<span class="n">Mat</span> <span class="n">img</span><span class="p">;</span>
<span class="n">Node</span><span class="o">*</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">5000</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">totnodes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">reached</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">step_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></code></pre></figure> <p>The <code class="highlighter-rouge">init()</code> function declares the position of the start point and the end point. The start point is marked blue and the end point red.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="nf">init</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">start_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
    <span class="n">start_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
    <span class="n">start_node</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">start_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span><span class="n">start_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">start_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">5</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">start_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">img</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
			<span class="n">img</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">img</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
    <span class="p">}</span>
	<span class="n">nodes</span><span class="p">[</span><span class="n">totnodes</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">start_node</span><span class="p">;</span>	
    <span class="n">end_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>
    <span class="n">end_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">end_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">end_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">end_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">5</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">end_node</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">img</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">img</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">img</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
		<span class="p">}</span>
    <span class="p">}</span>	
    <span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>
<span class="p">}</span></code></pre></figure> <p>The <code class="highlighter-rouge">near_node</code> function is responsible for finding the nearest node in the tree for a particular random node (<code class="highlighter-rouge">rnode</code>). The <code class="highlighter-rouge">node_dist</code> function takes two coordinates as its input and returns the distance between them.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">int</span> <span class="nf">near_node</span><span class="p">(</span><span class="n">Node</span> <span class="n">rnode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">float</span> <span class="n">min_dist</span> <span class="o">=</span> <span class="mf">999.0</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span> <span class="n">node_dist</span><span class="p">(</span><span class="n">start_node</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">rnode</span><span class="p">.</span><span class="n">position</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">lnode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">totnodes</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">dist</span> <span class="o">=</span> <span class="n">node_dist</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">,</span> <span class="n">rnode</span><span class="p">.</span><span class="n">position</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">dist</span> <span class="o">&lt;</span> <span class="n">min_dist</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">min_dist</span> <span class="o">=</span> <span class="n">dist</span><span class="p">;</span>
			<span class="n">lnode</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">lnode</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <p>The stepping function takes the random node generated (<code class="highlighter-rouge">rnode</code>) and its nearest node (<code class="highlighter-rouge">nnode</code>) in the tree as its input, and returns the coordinates of the step node. This function determines the step node by generating a new node at a distance of <code class="highlighter-rouge">step_size</code> from <code class="highlighter-rouge">nnode</code> towards <code class="highlighter-rouge">rnode</code>.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">coordi</span> <span class="nf">stepping</span><span class="p">(</span><span class="n">coordi</span> <span class="n">nnode</span><span class="p">,</span> <span class="n">coordi</span> <span class="n">rnode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">coordi</span> <span class="n">interm</span><span class="p">,</span> <span class="n">step</span><span class="p">;</span>
	<span class="kt">float</span> <span class="n">magn</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
	<span class="n">interm</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">rnode</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">nnode</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
	<span class="n">interm</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">rnode</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">nnode</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
	<span class="n">magn</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">interm</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">interm</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">interm</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">interm</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
	<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)(</span><span class="n">interm</span><span class="p">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">magn</span><span class="p">);</span>
	<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)(</span><span class="n">interm</span><span class="p">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">magn</span><span class="p">);</span>
	<span class="n">step</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">nnode</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">step_size</span><span class="o">*</span><span class="n">x</span><span class="p">);</span>
	<span class="n">step</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">nnode</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">step_size</span><span class="o">*</span><span class="n">y</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">step</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <p>The functions <code class="highlighter-rouge">check_validity_1</code> and <code class="highlighter-rouge">check_validity_2</code> take <code class="highlighter-rouge">nnode</code> and <code class="highlighter-rouge">step_node</code> as inputs. They check if the step node that has been generated is valid or not. It will be invalid if the step node either lies on a black pixel (that is, an obstacle) or if the straight line path joining <code class="highlighter-rouge">nnode</code> and step node goes through an obstacle. <code class="highlighter-rouge">0</code> is returned in case step node is invalid and <code class="highlighter-rouge">1</code> is returned in case step node is valid.</p> <p>The function <code class="highlighter-rouge">draw_path</code> draws the final path starting from the <code class="highlighter-rouge">end_node</code> to the <code class="highlighter-rouge">start_node</code> in green color.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="nf">draw_path</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">Node</span> <span class="n">up</span><span class="p">,</span> <span class="n">down</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">breaking</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">down</span> <span class="o">=</span> <span class="n">end_node</span><span class="p">;</span>
	<span class="n">up</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">end_node</span><span class="p">.</span><span class="n">parent</span><span class="p">);</span>
	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">{</span>
	    <span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="n">up</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">up</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">down</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">down</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">up</span><span class="p">.</span><span class="n">parent</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
	      <span class="k">break</span><span class="p">;</span>
	    <span class="n">up</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">up</span><span class="p">.</span><span class="n">parent</span><span class="p">);</span>
	    <span class="n">down</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">down</span><span class="p">.</span><span class="n">parent</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure> <p>The <code class="highlighter-rouge">rrt()</code> function executes the entire process of generating the random nodes and making the tree.</p> <p>Generation of a random point:</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="p">(</span><span class="n">rnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">).</span><span class="n">x</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">400</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">(</span><span class="n">rnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">).</span><span class="n">y</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">400</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span></code></pre></figure> <p>Index indicates the nearest node for a randomly generated node. <code class="highlighter-rouge">index = near_node(*rnode);</code></p> <p>Calling the stepping function to obtain the step node:</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="k">if</span><span class="p">((</span><span class="n">node_dist</span><span class="p">(</span><span class="n">rnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">,</span> <span class="n">nodes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">step_size</span><span class="p">)</span>
	<span class="k">return</span><span class="p">;</span>
<span class="k">else</span>
    <span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span> <span class="o">=</span> <span class="n">stepping</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">,</span> <span class="n">rnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">);</span></code></pre></figure> <p>Checking the validity of the step node. If valid, then both <code class="highlighter-rouge">flag1</code> and <code class="highlighter-rouge">flag2</code> would equal <code class="highlighter-rouge">1</code>.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">flag1</span> <span class="o">=</span> <span class="n">check_validity_1</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">,</span> <span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">);</span>
<span class="n">flag2</span> <span class="o">=</span> <span class="n">check_validity_2</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">,</span> <span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">);</span></code></pre></figure> <p>If the stepnode is valid, then stepnode is added to the tree:</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">nodes</span><span class="p">[</span><span class="n">totnodes</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">stepnode</span><span class="p">;</span>
<span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">parent</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
<span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">).</span><span class="n">push_back</span><span class="p">(</span><span class="n">stepnode</span><span class="p">);</span></code></pre></figure> <p>Joining the stepnode to the tree by a yellow line:</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Point</span><span class="p">((</span><span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">).</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">).</span><span class="n">x</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">nodes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span></code></pre></figure> <p>Marking the stepnodes green:</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">((</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">400</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">j</span><span class="o">&gt;</span><span class="mi">400</span><span class="p">))</span>
        	<span class="k">continue</span><span class="p">;</span>
        <span class="n">img</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">img</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
        <span class="n">img</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure> <p>The <code class="highlighter-rouge">end_node</code> is added to the tree if it fits the validity criteria and the distance between the <code class="highlighter-rouge">end_node</code> and the last step node is less than the <code class="highlighter-rouge">step_size</code>.</p> <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="k">if</span><span class="p">((</span><span class="n">check_validity_1</span><span class="p">(</span><span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">,</span> <span class="n">end_node</span><span class="p">.</span><span class="n">position</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">check_validity_2</span><span class="p">(</span><span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">,</span> <span class="n">end_node</span><span class="p">.</span><span class="n">position</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">node_dist</span><span class="p">(</span><span class="n">stepnode</span><span class="o">-&gt;</span><span class="n">position</span><span class="p">,</span><span class="n">end_node</span><span class="p">.</span><span class="n">position</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">step_size</span><span class="p">))</span>
<span class="p">{</span>
	<span class="n">reached</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">nodes</span><span class="p">[</span><span class="n">totnodes</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">end_node</span><span class="p">;</span>
	<span class="n">end_node</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">stepnode</span><span class="p">;</span>
	<span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">totnodes</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">).</span><span class="n">push_back</span><span class="p">(</span><span class="o">&amp;</span><span class="n">end_node</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure> <p>Final path is drawn in green: <code class="highlighter-rouge">draw_path();</code> Iteration number is incremented: <code class="highlighter-rouge">iter++;</code> Here is the output image after the implementation of the code:</p> <p><img src="/img/tutorial/pathplanning/rrt/output.png" alt="RRT Output" class="img-responsive" /></p> <p>For the complete code, click <a href="https://github.com/swadhagupta/RRT">here</a>. Find another implementation of the RRT Path Planning algorithm <a href="https://github.com/sourishg/rrt-umass">here</a>.</p> </div> </article> </div> </div> </div> </section> <!-- End Post --> <!-- Begin Footer --> <footer id="footer" class="footer"> <div class="row"> <div class="logo logo-footer pull-right"></div> </div> <div class="row"> <div class="col-md-4 col-xs-6"> <h5>Links</h5> <ul> <li><a href="https://drive.google.com/open?id=1jNJHFE1QjGOHFwhhzn6e774odGv-6eFQ" target="_blank">Robotix App</a></li> <li><a href="https://robotix.in/event/" target="_blank">Events</a></li> <li><a href="https://robotix.in/tutorial/" target="_blank">Tutorials</a></li> </ul> </div> <div class="col-md-4 col-xs-6"> <h5>Contacts</h5> <ul> <li><a href="https://contact.robotix.in" target="_blank">Contact Us</a></li> </ul> </div> <div class="col-md-4 col-xs-6"> <h5>Archives</h5> <ul> <li><a href="https://2018.robotix.in/" target="_blank">Robotix 2018</a></li> <li><a href="https://2017.robotix.in/" target="_blank">Robotix 2017</a></li> <li><a href="https://2016.robotix.in/" target="_blank">Robotix 2016</a></li> </ul> </div> </div> <div class="row"> <div class="col-md-6 col-xs-12"> <ul class="social-links"> <li> <a href="https://plus.google.com/102868621563384739622/" target="_blank"> <svg class="icn icon-google-plus" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-google-plus"></use> </svg> </a> </li> <li> <a href="https://twitter.com/RobotixIITKgp" target="_blank"> <svg class="icn icon-twitter" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-twitter"></use> </svg> </a> </li> <li> <a href="https://facebook.com/robotixiitkgp" target="_blank"> <svg class="icn icon-facebook" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-facebook"></use> </svg> </a> </li> <li> <a href="https://www.youtube.com/robotixiitkgp" target="_blank"> <svg class="icn icon-youtube" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-youtube"></use> </svg> </a> </li> <li> <a href="/feed.xml" target="_blank"> <svg class="icn icon-rss" viewBox="0 0 30 32"> <use xlink:href="/img/sprites/sprites.min.svg#icon-rss"></use> </svg> </a> </li> </ul> </div> </div> <div class="row"> <!-- Please don't delete this line--> <div class="col-md-6"> <p class="copyright"> &copy; 2018 Technology Robotix Society, IIT Kharagpur </p> </div> </div> </footer> <!-- End Footer --> </div> </div> </div> <!-- Begin Floating Action button--> <ul class="fab"> <li> <input type="text" class="search input-sm form-control" placeholder="Search the site..."> <button class="btn btn-danger waves-circle waves-effect waves-light waves-float rotate"> <h4 class="fab-text media-middle"><b>+</b></h4> </button> </li> </ul> <script> window.jQuery || document.write('<script src="/js/jquery-2.1.1.min.js"><\/script>') </script> <script> document.write('<script src="/js/bootstrap.min.js"><\/script>') </script> <script src="/js/default.min.js"></script> <script>Waves.displayEffect();</script> <script src="/js/scripts.min.js"></script> <script> (function(){ var handle = '@robotixiitkgp'; var a = document.createElement('script'); var m = document.getElementsByTagName('script')[0]; a.async = 1; a.src = 'https://nectar.ninja/api/v1/' + handle.slice(1); m.parentNode.insertBefore(a, m); })(); </script> <script> (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){ (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t); e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e); })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st'); _st('install','a_iioDrTs6zXmqH8x5Yr','2.0.0'); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-83617238-1', 'auto'); ga('send', 'pageview'); </script> </body> </html>
